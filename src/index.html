<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PoC</title>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.min.js"></script>
</head>
<body>
  <div id="app">
    <h1>index</h1>
    <button v-on:click="login1">login1</button>
    <button v-on:click="login2">login2</button>
    <button v-on:click="login3">login3</button>
    <button v-on:click="logout">logout</button>
  </div>

  <script>
  var app = new Vue({
    el: '#app',
    methods: {
      login1: function() {
        window.location.href = "localhost:8080/login1";
      },
      login2: function() {
        window.location.href = "localhost:8080/login4";
      },
      login3: function() {
        console.log("Azione 3 eseguita!");
      },
      logout: function() {
        try {
            const logoutUrl = "http://localhost:8085/realms/myrealm/protocol/openid-connect/logout";
            //const session = req.session as CustomSession;
            const params = new URLSearchParams({
              response_type: "code",
              client_id: session.clientId || "my_default_client_id",
              post_logout_redirect_uri: redirectUri,
            });
            const logoutRedirectUrl = `${logoutUrl}?${params.toString()}`;
            req.session.destroy((error) => {
              if (error) {
                console.error("Error destroying session:", error);
                res.status(500).json({ error: "Error during logout" });
              } else {
                res.status(302).redirect(logoutRedirectUrl);
              }
            });
          } catch (error) {
            console.error("Error during logout:", error);
            res.status(500).json({ error: "Error during logout" });
          }
      }
    }
  });
  </script>
</body>
</html>
